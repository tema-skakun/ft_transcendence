{"ast":null,"code":"var _jsxFileName = \"/Users/ulagrezina/Desktop/ft_transcendence/pong/src/components/Content/Game/Game.tsx\",\n  _s = $RefreshSig$();\nimport React from 'react';\nimport io from 'socket.io-client';\nimport { useSocket } from './hooks/useSocket';\nimport { useAnimation } from './hooks/useAnimation';\nimport { useRef, useState, useCallback } from 'react';\nimport { clear } from './components/initalize';\nimport { dot } from './components/dot';\nimport { useCanvas } from './hooks/useCanvas';\nimport { paddle } from './components/paddle';\nimport { useKeydown } from './hooks/useKeyhook';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst socket = io('http://localhost:5000');\nfunction handleKeyDown(ev) {\n  socket.emit('keyDown', ev.code);\n}\nwindow.addEventListener('beforeunload', () => {\n  socket.disconnect();\n});\nexport default function Game(props) {\n  _s();\n  const gameStateRef = useRef(null);\n  const CanvasRef = useRef(null);\n  const [drawingContext, setDrawingContext] = useState(null);\n  const [CONFIG, setCONFIG] = useState(null);\n\n  // useSocketLifecycle(socket);\n\n  useSocket(socket, 'handshake', useCallback(CONFIG_STR => {\n    console.log('RECIEVED HANDSHAKE');\n    setCONFIG(JSON.parse(CONFIG_STR));\n  }, [setCONFIG]));\n  useSocket(socket, 'playerLeft', useCallback(() => {\n    console.log('A PLAYER JUST LEFT!');\n  }, []));\n  useKeydown(handleKeyDown);\n  useSocket(socket, 'gameState', useCallback(GAMESTATE_STR => {\n    gameStateRef.current = JSON.parse(GAMESTATE_STR);\n  }, []));\n  useSocket(socket, 'goal', useCallback(PLAYER_STR => {\n    console.log(PLAYER_STR);\n  }, []));\n  useCanvas(CanvasRef, CONFIG, setDrawingContext);\n  function LoopCallback() {\n    if (!drawingContext || !CONFIG) return;\n    clear(CONFIG, drawingContext);\n    if (gameStateRef.current) {\n      dot(CONFIG, drawingContext, gameStateRef.current);\n      paddle(CONFIG, drawingContext, gameStateRef.current, 1);\n      paddle(CONFIG, drawingContext, gameStateRef.current, 2);\n    }\n    requestAnimationFrame(LoopCallback);\n  }\n  useAnimation(LoopCallback, drawingContext, CONFIG);\n  return /*#__PURE__*/_jsxDEV(\"canvas\", {\n    ref: CanvasRef\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 2\n  }, this);\n}\n_s(Game, \"S9Ojq5fypJ06O1HDtiZN2g/qOEk=\", false, function () {\n  return [useSocket, useSocket, useKeydown, useSocket, useSocket, useCanvas, useAnimation];\n});\n_c = Game;\nvar _c;\n$RefreshReg$(_c, \"Game\");","map":{"version":3,"names":["React","io","useSocket","useAnimation","useRef","useState","useCallback","clear","dot","useCanvas","paddle","useKeydown","jsxDEV","_jsxDEV","socket","handleKeyDown","ev","emit","code","window","addEventListener","disconnect","Game","props","_s","gameStateRef","CanvasRef","drawingContext","setDrawingContext","CONFIG","setCONFIG","CONFIG_STR","console","log","JSON","parse","GAMESTATE_STR","current","PLAYER_STR","LoopCallback","requestAnimationFrame","ref","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/ulagrezina/Desktop/ft_transcendence/pong/src/components/Content/Game/Game.tsx"],"sourcesContent":["import React from 'react';\nimport io from 'socket.io-client';\nimport {useSocket} from './hooks/useSocket';\nimport { useAnimation} from './hooks/useAnimation'\nimport { Socket } from 'socket.io-client'\nimport { Config } from './interfaces/config';\nimport { GameState } from './hooks/useSocket';\n\nimport { useRef, useState, useCallback } from 'react';\n\nimport { clear } from './components/initalize';\nimport { dot } from './components/dot';\nimport { useCanvas } from './hooks/useCanvas';\nimport { paddle } from './components/paddle';\nimport { useKeydown } from './hooks/useKeyhook';\nimport { useSocketLifecycle } from './hooks/useSocketLifecycle';\n\nconst socket: Socket<any, any> = io('http://localhost:5000');\n\nfunction handleKeyDown(this: Document, ev: KeyboardEvent) {\n\tsocket.emit('keyDown', ev.code);\n}\n\nwindow.addEventListener('beforeunload', () => {\n\tsocket.disconnect();\n}); \n\nexport default function Game(props:any) {\n\tconst gameStateRef: React.MutableRefObject<GameState | null> = useRef(null);\n\tconst CanvasRef: React.RefObject<HTMLCanvasElement> = useRef<HTMLCanvasElement>(null);\n\n\tconst [drawingContext, setDrawingContext] = useState<CanvasRenderingContext2D | null>(null)\n\tconst [CONFIG, setCONFIG] = useState<Config | null>(null);\n\n\t// useSocketLifecycle(socket);\n\n\t\tuseSocket(socket, 'handshake', useCallback((CONFIG_STR: string) => {\n\t\t\tconsole.log('RECIEVED HANDSHAKE');\n\t\t\tsetCONFIG(JSON.parse(CONFIG_STR))\n\t\t}, [setCONFIG]))\n\n\t\tuseSocket(socket, 'playerLeft', useCallback(() => {\n\t\t\tconsole.log('A PLAYER JUST LEFT!');\n\t\t}, []))\n\n\tuseKeydown(handleKeyDown)\n\n\tuseSocket(socket, 'gameState', useCallback((GAMESTATE_STR) => {\n\t\tgameStateRef.current = JSON.parse(GAMESTATE_STR);\n\t}, []))\n\n\tuseSocket(socket, 'goal', useCallback((PLAYER_STR) => {\n\t\tconsole.log(PLAYER_STR);\n\t}, []))\n\n\tuseCanvas(CanvasRef, CONFIG, setDrawingContext);\n\n\tfunction LoopCallback() {\n\t\tif (!drawingContext || !CONFIG)\n\t\t\treturn ;\n\n\t\tclear(CONFIG, drawingContext);\n\t\tif (gameStateRef.current)\n\t\t{\n\t\t\tdot(CONFIG, drawingContext, gameStateRef.current);\n\t\t\tpaddle(CONFIG, drawingContext, gameStateRef.current, 1);\n\t\t\tpaddle(CONFIG, drawingContext, gameStateRef.current, 2);\n\t\t}\n\n\t\trequestAnimationFrame(LoopCallback);\n\t}\n\n\tuseAnimation(LoopCallback, drawingContext, CONFIG);\n\n  return (\n\t<canvas ref={CanvasRef}>\n\t</canvas>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}